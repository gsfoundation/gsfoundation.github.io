"use strict";(self.webpackChunkwebsite_react=self.webpackChunkwebsite_react||[]).push([[269],{269:function(e,t,n){n.r(t),n.d(t,{GsCompilationResult:function(){return He},compileGsToAst:function(){return $e},transpileGsAstToJs:function(){return Me},transpileGsToJs:function(){return _e},transpileJsToGs:function(){return Ke}});var r=n(652);const s=(e,t)=>e.appendGs(t),i=(e,t)=>e.appendJs(t),a=(e,t)=>e.toGsString(t),o=(e,t)=>e.toJsString(t);class l{constructor(e={prettyOutput:!0}){this.options=e,this.result="",this.currentTabLevel=0}toString(){return this.result}appendTab(){this.options.prettyOutput&&this.currentTabLevel>0&&(this.result+=" ".repeat(4*this.currentTabLevel))}append(e){this.result+=e}appendExpression(e,t){this.result+=t(e,this.options)}appendInRoundBrackets(e){this.result+=this.options.prettyOutput?" (":"(",this.result+=e,this.result+=")"}appendExprInRoundBrackets(e,t){this.appendInRoundBrackets(t(e,this.options))}appendBlock(e,t){e.forEach((e=>{this.appendTab();t(e,this).appendSemicolon&&this.append(";"),this.options.prettyOutput&&this.append("\n")}))}openBlock(){const e=this.options.prettyOutput;this.result+=e?" {":"{",this.options.prettyOutput&&(this.result+="\n"),this.currentTabLevel++}closeBlock(){this.currentTabLevel--,this.appendTab(),this.append(this.options.prettyOutput?"} ":"}")}}var p;!function(e){e[e.Round=0]="Round",e[e.Square=1]="Square",e[e.Curl=2]="Curl"}(p||(p={}));class c{static parseBlockStatementWithExpr(e){const t=c.parseBlockStatementWithHeader(e);return{expr:c.parseExpression(t.header),block:t.block}}static parseBlockStatementWithHeader(e){e.expectTokenAt(1,"(");const t=e.findClosingBracketIndex(p.Round);if(t<0)throw new Error(") expected");e.expectTokenAt(t+1,"{"),e.expectTokenAt(e.length-1,"}");const n=e.substring(2,t),r=e.substring(t+2,e.length-1);return{header:n,block:c.parseCodeBlock(r)}}static parseBlockStatementWithNoHeader(e){e.expectTokenAt(1,"{"),e.expectTokenAt(e.length-1,"}");const t=e.substring(2,e.length-1);return c.parseCodeBlock(t)}static parseCodeBlock(e){const t=function(e){const t=[];for(var n=0,r=0,s=0;s<e.length;s++){const a=e.at(s);switch(a){case"[":case"(":r++;break;case"]":case")":if(--r<0)throw new Error("Invalid sequence of brackets")}const o=s==e.length-1;if(0==r&&";"==a||o){var i;i=o&&";"!=a?e.length:s;const r=e.substring(n,i);n=s+1,r.length>0&&t.push(r)}else if(0==r&&"{"==a){const r=e.substring(s).findClosingBracketIndex(p.Curl);if(r<0)throw new Error("} expected");s+=r;const i=e.substring(n,s+1);n=s+1,i.length>0&&t.push(i)}}return t}(e),n=[];for(var r=0;r<t.length;){let e=null;for(const n of ne){const s=n.tryParseGs(t,r);if(null!=s){null!=s.nextIndex?r=s.nextIndex:r++,e=s.statement;break}}if(null==e)throw new Error(`${t[r]} cannot be parsed`);n.push(e)}return n}static tryParseExpression(e){if(0==e.length)return null;if(e.length>1&&"("==e.firstToken()&&")"==e.lastToken()){const t=e.substring(1,e.length-1);t.isBracketSequenceValid()&&(e=t)}for(const t of Ze){const n=t.tryParseGs(e);if(null!=n)return n}return null}static parseExpression(e){if(0==e.length)throw new Error("Expression expected");const t=c.tryParseExpression(e);if(null==t)throw new Error(`'${e.toString()}' cannot be parsed`);return t}}const u={appendSemicolon:!0};class h{constructor(e,t){this.left=e,this.right=t,this.type=2}computeByteSize(){return se.binaryExpressionSize(this.left)+se.binaryExpressionSize(this.right)}writeBinary(e){e.emitExpression(this.left),e.emitExpression(this.right)}appendInternal(e,t){const n=e.options;return e.append(t(this.left,n)),e.append(n.prettyOutput?" = ":"="),e.append(t(this.right,n)),u}appendGs(e){return this.appendInternal(e,a)}appendJs(e){return this.appendInternal(e,o)}}class d{readBinary(e){const t=e.readExpression(),n=e.readExpression();return new h(t,n)}tryParseGs(e,t){const n=e[t],r=n.indexOfOnZeroLevel("=");if(r>0){const e=n.substring(0,r),t=c.parseExpression(e),s=n.substring(r+1),i=c.parseExpression(s);return{statement:new h(t,i)}}return null}tryParseJs(e){if("ExpressionStatement"==e.type){const t=e.expression;if("AssignmentExpression"==t.type){const e=qe.parseJsExpression(t.left),n=qe.parseJsExpression(t.right);return new h(e,n)}}return null}}class f{constructor(e){this.expr=e,this.type=3}computeByteSize(){return se.binaryExpressionSize(this.expr)}writeBinary(e){e.emitExpression(this.expr)}appendGs(e){return e.append(this.expr.toGsString(e.options)),{appendSemicolon:!0}}appendJs(e){return e.append(this.expr.toJsString(e.options)),{appendSemicolon:!0}}}class y{readBinary(e){const t=e.readExpression();return new f(t)}tryParseGs(e,t){const n=e[t],r=c.tryParseExpression(n);return null!=r?{statement:new f(r)}:null}tryParseJs(e){if("ExpressionStatement"==e.type){const t=qe.parseJsExpression(e.expression);return new f(t)}return null}}class g{constructor(e){this.body=e}}function w(e,t){return t?"("+e+")":e}function m(e,t,n){if(t+n.length>e.length)return!1;for(var r=0;r<n.length;r++)if(e[t+r]!=n[r])return!1;return!0}function b(e,t){return e.join(t.prettyOutput?", ":",")}function x(e,t,n){var r="";const s=e.length-1,i=t.prettyOutput?", ":",";return e.forEach(((e,a)=>{r+=n(e,t),a<s&&(r+=i)})),r}function S(e){return e>="0"&&e<="9"}function k(e){return function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}(e)||S(e)||"_"==e}function E(e){if(0==e.length)return!1;if(S(e[0]))return!1;for(const t of e)if(!k(t))return!1;return!0}const B={appendSemicolon:!0};class v{constructor(e,t,n){this.isConst=e,this.varName=t,this.initValue=n,this.type=0}computeByteSize(){var e=1;return e+=se.binaryStringSize(this.varName),null!=this.initValue&&(e+=se.binaryExpressionSize(this.initValue)),e}writeBinary(e){var t=0;this.isConst&&(t|=1),null!=this.initValue&&(t|=2),e.emitU8(t),e.emitString(this.varName),null!=this.initValue&&e.emitExpression(this.initValue)}appendInternal(e,t,n,r){return e.append(this.isConst?t:n),e.append(" "),e.append(this.varName),null!=this.initValue&&(e.append(e.options.prettyOutput?" = ":"="),e.append(r(this.initValue,e.options))),B}appendGs(e){return this.appendInternal(e,"sir","slave",a)}appendJs(e){return this.appendInternal(e,"const","var",o)}}class J{readBinary(e){const t=e.readU8(),n=0!=(1&t),r=0!=(2&t),s=e.readString();var i=null;return r&&(i=e.readExpression()),new v(n,s,i)}tryParseGs(e,t){const n=e[t];if(n.length>0){const e=n.firstToken(),t="sir"==e;if("slave"==e||t){var r=null;const e=n.at(1);if(!E(e))throw new Error("Invalid var name");const s=n.indexOf("=");if(s>0){if(2!=s)throw new Error("= expected");const e=n.substring(3,n.length);r=c.parseExpression(e)}else if(t)throw new Error("Constant should be initialized");return{statement:new v(t,e,r)}}}return null}tryParseJs(e){if("VariableDeclaration"==e.type){if(e.declarations.length>1)throw new Error("More than 1 declaration in variable cannot be parsed");const n=e.declarations[0],r=n.id;if("Identifier"!=r.type)throw new Error("JS cannot be parsed");var t=null;return null!=n.init&&(t=qe.parseJsExpression(n.init)),new v("const"==e.kind,r.name,t)}return null}}const I={appendSemicolon:!1};class z extends g{constructor(e,t,n,r){super(r),this.init=e,this.cond=t,this.update=n,this.type=6}computeByteSize(){var e=1;return null!=this.init&&(this.init.isVar?e+=this.init.value.computeByteSize():e+=se.binaryExpressionSize(this.init.value)),null!=this.cond&&(e+=se.binaryExpressionSize(this.cond)),null!=this.update&&(e+=se.binaryExpressionSize(this.update)),e+=se.binaryCodeBlockSize(this.body)}writeBinary(e){var t=0;null!=this.init&&(t|=1,t|=this.init.isVar?2:0),t|=null!=this.cond?4:0,t|=null!=this.update?8:0,e.emitU8(t),null!=this.init&&(this.init.isVar?this.init.value.writeBinary(e):e.emitExpression(this.init.value)),null!=this.cond&&e.emitExpression(this.cond),null!=this.update&&e.emitExpression(this.update),e.emitCodeBlock(this.body)}appendInternal(e,t,n,r){const s=e.options.prettyOutput;e.append(t),e.append(s?" (":"(");const i=s?"; ":";";return null!=this.init&&(this.init.isVar?r(this.init.value,e):e.append(n(this.init.value,e.options))),e.append(i),null!=this.cond&&e.append(n(this.cond,e.options)),e.append(i),null!=this.update&&e.append(n(this.update,e.options)),e.append(")"),e.openBlock(),e.appendBlock(this.body,r),e.closeBlock(),I}appendGs(e){return this.appendInternal(e,"van",a,s)}appendJs(e){return this.appendInternal(e,"for",o,i)}}class T{readBinary(e){var t=null,n=null,r=null;const s=e.readU8();0!=(1&s)&&(t=0!=(2&s)?{isVar:!0,value:(new J).readBinary(e)}:{isVar:!1,value:e.readExpression()}),null!=(4&s)&&(n=e.readExpression()),null!=(8&s)&&(r=e.readExpression());const i=e.readCodeBlock();return new z(t,n,r,i)}tryParseGs(e,t){const n=e[t];if(n.length>1&&"van"==n.firstToken()){const e=c.parseBlockStatementWithHeader(n),t=e.header.splitOnZeroLevel(";");if(3!=t.length)throw new Error("Invalid declaration of van-loop");var r=null,s=null,i=null;const a=t[0],o=t[1],l=t[2];if(a.length>0){const e=(new J).tryParseGs([a],0);if(null!=e)r={isVar:!0,value:e.statement};else{r={isVar:!1,value:c.parseExpression(a)}}}return o.length>0&&(s=c.parseExpression(o)),l.length>0&&(i=c.parseExpression(l)),{statement:new z(r,s,i,e.block)}}return null}tryParseJs(e){if("ForStatement"==e.type){var t=null,n=null,r=null;if(null!=e.init)if("VariableDeclaration"==e.init.type){const n=(new J).tryParseJs(e.init);if(null==n)throw new Error("Variable declaration expected");t={isVar:!0,value:n}}else t={isVar:!1,value:qe.parseJsExpression(e.init)};null!=e.test&&(n=qe.parseJsExpression(e.test)),null!=e.update&&(r=qe.parseJsExpression(e.update));const s=qe.parseJsBlockOrSingle(e.body);return new z(t,n,r,s)}return null}}class C extends g{constructor(e,t,n){super(n),this.name=e,this.params=t,this.type=1}computeByteSize(){return se.binaryStringSize(this.name)+se.binaryStringArraySize(this.params)+se.binaryCodeBlockSize(this.body)}writeBinary(e){e.emitString(this.name),e.emitStringArray(this.params),e.emitCodeBlock(this.body)}appendInternal(e,t,n){return e.append(t),e.append(" "),e.append(this.name),e.append("("),e.append(b(this.params,e.options)),e.append(")"),e.openBlock(),e.appendBlock(this.body,n),e.closeBlock(),{appendSemicolon:!1}}appendGs(e){return this.appendInternal(e,"fisting",s)}appendJs(e){return this.appendInternal(e,"function",i)}}class U{readBinary(e){const t=e.readString(),n=e.readStringArray(),r=e.readCodeBlock();return new C(t,n,r)}tryParseGs(e,t){const n=e[t];if("fisting"==n.firstToken()){n.expectTokenAt(2,"(");const e=n.indexOf(")");if(e<0)throw new Error(") expected");n.expectTokenAt(e+1,"{"),n.expectTokenAt(n.length-1,"}");const t=n.at(1);if(!E(t))throw new Error("Invalid function name");const s=n.substring(3,e);var r=[];if(s.length>0&&!(r=s.splitToSingleTokens(",")).every(E))throw new Error("Invalid names of arguments");const i=n.substring(e+2,n.length-1),a=c.parseCodeBlock(i);return{statement:new C(t,r,a)}}return null}tryParseJs(e){if("FunctionDeclaration"==e.type){if(null==e.id)throw new Error("Internal error: id is null");const t=e.id.name,n=e.params.map((e=>{if("Identifier"==e.type)return e.name;throw new Error("Function declaration cannot be parsed because of params")})),r=qe.parseJsBlock(e.body.body);return new C(t,n,r)}return null}}function P(e,t,n,r,s){e.append(t),e.appendExprInRoundBrackets(n.expr,r),e.openBlock(),e.appendBlock(n.block,s),e.closeBlock()}function A(e){return se.binaryExpressionSize(e.expr)+se.binaryCodeBlockSize(e.block)}function G(e,t){t.emitExpression(e.expr),t.emitCodeBlock(e.block)}function O(e){return{expr:e.readExpression(),block:e.readCodeBlock()}}class N{constructor(e,t,n){this.mainClause=e,this.elifClauses=t,this.elseBlock=n,this.type=9}computeByteSize(){var e=A(this.mainClause);e+=4;for(const t of this.elifClauses)e+=A(t);return e+=1,null!=this.elseBlock&&(e+=se.binaryCodeBlockSize(this.elseBlock)),e}writeBinary(e){G(this.mainClause,e),e.emitU32(this.elifClauses.length);for(const t of this.elifClauses)G(t,e);null!=this.elseBlock?(e.emitU8(1),e.emitCodeBlock(this.elseBlock)):e.emitU8(0)}appendInternal(e,t,n,r){return P(e,"if",this.mainClause,n,r),this.elifClauses.forEach((s=>{P(e,t,s,n,r)})),null!=this.elseBlock&&(e.append("else"),e.openBlock(),e.appendBlock(this.elseBlock,r),e.closeBlock()),{appendSemicolon:!1}}appendGs(e){return this.appendInternal(e,"elif",a,s)}appendJs(e){return this.appendInternal(e,"else if",o,i)}}class L{readBinary(e){const t=O(e),n=e.readU32(),r=new Array(n);for(var s=0;s<n;s++)r[s]=O(e);var i=null;return 1==e.readU8()&&(i=e.readCodeBlock()),new N(t,r,i)}tryParseGs(e,t){const n=e[t];if(n.length>0&&"if"==n.firstToken()){const i=c.parseBlockStatementWithExpr(n),a=[];for(var r=null,s=t+1;s<e.length;s++){const t=e[s];if(!(t.length>0&&"elif"==t.firstToken())){if(t.length>0&&"else"==t.firstToken()){r=c.parseBlockStatementWithNoHeader(t),s++;break}break}{const e=c.parseBlockStatementWithExpr(t);a.push(e)}}return{statement:new N(i,a,r),nextIndex:s}}return null}tryParseJs(e){if("IfStatement"==e.type){const n=qe.parseJsExpression(e.test),r=qe.parseJsBlockOrSingle(e.consequent);var t=null;return null!=e.alternate&&(t=qe.parseJsBlockOrSingle(e.alternate)),new N({expr:n,block:r},[],t)}return null}}class j{constructor(e,t){this.condition=e,this.body=t,this.type=8}computeByteSize(){return se.binaryExpressionSize(this.condition)+se.binaryCodeBlockSize(this.body)}writeBinary(e){e.emitExpression(this.condition),e.emitCodeBlock(this.body)}appendInternal(e,t,n,r){return e.append("do"),e.openBlock(),e.appendBlock(this.body,n),e.closeBlock(),e.append(t),e.appendExprInRoundBrackets(this.condition,r),{appendSemicolon:!1}}appendGs(e){return this.appendInternal(e,"anal",s,a)}appendJs(e){return this.appendInternal(e,"while",i,o)}}class V{readBinary(e){const t=e.readExpression(),n=e.readCodeBlock();return new j(t,n)}tryParseGs(e,t){const n=e[t];if(n.length>1&&"do"==n.firstToken()){const r=c.parseBlockStatementWithNoHeader(n);if(t==e.length-1)throw new Error("Do-block should not be last");const s=e[t+1];if("anal"!=s.firstToken())throw new Error("Anal-statement should always be after do-block");s.expectTokenAt(1,"("),s.expectTokenAt(s.length-1,")");const i=s.substring(2,s.length-1),a=c.parseExpression(i);return{statement:new j(a,r),nextIndex:t+2}}return null}tryParseJs(e){if("DoWhileStatement"==e.type){var t=e.body;if("BlockStatement"!=t.type)throw new Error("JS statement cannot be parsed");const n=qe.parseJsExpression(e.test),r=qe.parseJsBlock(t.body);return new j(n,r)}return null}}const W={appendSemicolon:!1};class Z extends g{constructor(e,t){super(t),this.cond=e,this.type=7}computeByteSize(){return se.binaryExpressionSize(this.cond)+se.binaryCodeBlockSize(this.body)}writeBinary(e){e.emitExpression(this.cond),e.emitCodeBlock(this.body)}appendGs(e){return e.append("cumming"),e.appendInRoundBrackets(this.cond.toJsString(e.options)),e.openBlock(),e.appendBlock(this.body,s),e.closeBlock(),W}appendJs(e){return e.append("while"),e.appendInRoundBrackets(this.cond.toJsString(e.options)),e.openBlock(),e.appendBlock(this.body,i),e.closeBlock(),W}}class R{readBinary(e){const t=e.readExpression(),n=e.readCodeBlock();return new Z(t,n)}tryParseGs(e,t){const n=e[t];if(n.length>1&&"cumming"==n.firstToken()){const e=c.parseBlockStatementWithExpr(n);return{statement:new Z(e.expr,e.block)}}return null}tryParseJs(e){if("WhileStatement"==e.type){const t=qe.parseJsExpression(e.test),n=qe.parseJsBlockOrSingle(e.body);return new Z(t,n)}return null}}const q={appendSemicolon:!0};class D{constructor(){this.type=4}computeByteSize(){return 0}writeBinary(e){}appendGs(e){return e.append("break"),q}appendJs(e){return e.append("break"),q}}class F{constructor(){this.type=5}computeByteSize(){return 0}writeBinary(e){}appendGs(e){return e.append("continue"),q}appendJs(e){return e.append("continue"),q}}class H{readBinary(e){return new D}tryParseGs(e,t){const n=e[t];return 1==n.length&&"break"==n.firstToken()?{statement:new D}:null}tryParseJs(e){return"BreakStatement"==e.type?new D:null}}class ${readBinary(e){return new F}tryParseGs(e,t){const n=e[t];return 1==n.length&&"continue"==n.firstToken()?{statement:new F}:null}tryParseJs(e){return"ContinueStatement"==e.type?new F:null}}const M={appendSemicolon:!0};class _{constructor(e){this.value=e,this.type=10}computeByteSize(){var e=1;return null!=this.value&&(e+=se.binaryExpressionSize(this.value)),e}writeBinary(e){null!=this.value?(e.emitU8(1),e.emitExpression(this.value)):e.emitU8(0)}appendInternal(e,t,n){return e.append(t),null!=this.value&&(e.append(" "),e.append(n(this.value))),M}appendGs(e){return this.appendInternal(e,"return",(t=>t.toGsString(e.options)))}appendJs(e){return this.appendInternal(e,"return",(t=>t.toJsString(e.options)))}}class K{readBinary(e){var t=null;return 1==e.readU8()&&(t=e.readExpression()),new _(t)}tryParseGs(e,t){const n=e[t];if(n.length>0&&"return"==n.firstToken()){const e=n.substring(1);var r=null;return e.length>0&&(r=c.parseExpression(e)),{statement:new _(r)}}return null}tryParseJs(e){if("ReturnStatement"==e.type){if(null==e.argument)return new _(null);const t=qe.parseJsExpression(e.argument);return new _(t)}return null}}const Q={appendSemicolon:!1};class X{constructor(e,t,n){this.tryBody=e,this.catchClause=t,this.finallyBody=n,this.type=11}computeByteSize(){var e=se.binaryCodeBlockSize(this.tryBody);return e+=1,null!=this.catchClause&&(e+=se.binaryStringSize(this.catchClause.param),e+=se.binaryCodeBlockSize(this.catchClause.body)),e+=1,null!=this.finallyBody&&(e+=se.binaryCodeBlockSize(this.finallyBody)),e}writeBinary(e){e.emitCodeBlock(this.tryBody),null!=this.catchClause?(e.emitU8(1),e.emitString(this.catchClause.param),e.emitCodeBlock(this.catchClause.body)):e.emitU8(0),null!=this.finallyBody?(e.emitU8(1),e.emitCodeBlock(this.finallyBody)):e.emitU8(0)}appendInternal(e,t){return e.append("try"),e.openBlock(),e.appendBlock(this.tryBody,t),e.closeBlock(),null!=this.catchClause&&(e.append("catch"),e.appendInRoundBrackets(this.catchClause.param),e.openBlock(),e.appendBlock(this.catchClause.body,t),e.closeBlock()),null!=this.finallyBody&&(e.append("finally"),e.openBlock(),e.appendBlock(this.finallyBody,t),e.closeBlock()),Q}appendGs(e){return this.appendInternal(e,s)}appendJs(e){return this.appendInternal(e,i)}}class Y{readBinary(e){const t=e.readCodeBlock();var n=null,r=null;if(1==e.readU8()){n={param:e.readString(),body:e.readCodeBlock()}}if(1==e.readU8()&&(r=e.readCodeBlock()),null==n&&null==r)throw new Error("No catch-clause nor finally body are found");return new X(t,n,r)}tryParseGs(e,t){const n=e[t];if("try"==n.firstToken()){const a=c.parseBlockStatementWithNoHeader(n);if(t==e.length-1)throw new Error("Try-block should not be last");var r=null,s=null,i=t+1;const o=e[i];if("catch"==o.firstToken()){const n=c.parseBlockStatementWithHeader(o),a=n.header;if(1!=a.length)throw new Error("Identifier expected at catch-clause");const l=a.firstToken();if(!E(l))throw new Error("Invalid catch-param name");if(r={param:l,body:n.block},i++,t<e.length-2){const n=e[t+2];"finally"==n.firstToken()&&(s=c.parseBlockStatementWithNoHeader(n),i++)}}else"finally"==o.firstToken()&&(s=c.parseBlockStatementWithNoHeader(o),i++);if(null==r&&null==s)throw new Error("Catch-block or finally-block expected");return{statement:new X(a,r,s),nextIndex:i}}return null}tryParseJs(e){if("TryStatement"==e.type){const r=qe.parseJsBlock(e.block.body);var t=null,n=null;if(null!=e.handler){const n=qe.parseJsBlock(e.handler.body.body),r=e.handler.param;if(null==r)throw new Error("Internal error: catchParam is null");if("Identifier"!=r.type)throw new Error("Catch-var should be identifier");t={param:r.name,body:n}}return null!=e.finalizer&&(n=qe.parseJsBlock(e.finalizer.body)),new X(r,t,n)}return null}}class ee{constructor(e){this.expr=e,this.type=12}computeByteSize(){return se.binaryExpressionSize(this.expr)}writeBinary(e){e.emitExpression(this.expr)}appendGs(e){return e.append("penetrate-with "),e.appendExpression(this.expr,a),{appendSemicolon:!0}}appendJs(e){return e.append("throw "),e.appendExpression(this.expr,a),{appendSemicolon:!0}}}class te{readBinary(e){return new ee(e.readExpression())}tryParseGs(e,t){const n=e[t];if("penetrate-with"==n.firstToken()){const e=n.substring(1),t=c.parseExpression(e);return{statement:new ee(t)}}return null}tryParseJs(e){if("ThrowStatement"==e.type){const t=qe.parseJsExpression(e.argument);return new ee(t)}return null}}const ne=[new T,new J,new d,new L,new V,new R,new H,new $,new K,new Y,new U,new te,new y],re=[new J,new U,new d,new y,new H,new $,new T,new R,new V,new L,new K,new Y,new te];class se{constructor(e){this.pos=0,this.buffer=Buffer.allocUnsafe(e)}static binaryStringSize(e){return 4+e.length}static binaryArraySize(e,t){var n=4;for(const r of e)n+=t(r);return n}static binaryStringArraySize(e){return this.binaryArraySize(e,this.binaryStringSize)}static binaryExpressionSize(e){return 1+e.computeByteSize()}static binaryStatementSize(e){return 1+e.computeByteSize()}static binaryCodeBlockSize(e){return this.binaryArraySize(e,this.binaryStatementSize)}static binaryExpressionArraySize(e){return this.binaryArraySize(e,this.binaryExpressionSize)}size(){return this.buffer.length}position(){return this.pos}emitU8(e){this.buffer.writeUInt8(e,this.pos),this.pos++}emitU32(e){this.buffer.writeUInt32LE(e,this.pos),this.pos+=4}emitDouble(e){this.buffer.writeDoubleLE(e,this.pos),this.pos+=8}emitString(e){this.emitU32(e.length),this.buffer.write(e,this.pos,"utf-8"),this.pos+=e.length}emitStringArray(e){this.emitU32(e.length);for(const t of e)this.emitString(t)}emitExpression(e){this.emitU8(e.type),e.writeBinary(this)}emitStatement(e){this.emitU8(e.type),e.writeBinary(this)}emitCodeBlock(e){this.emitU32(e.length);for(const t of e)this.emitStatement(t)}emitExpressionArray(e){this.emitU32(e.length);for(const t of e)this.emitExpression(t)}readU8(){return this.buffer.readUInt8(this.pos++)}readU32(){const e=this.buffer.readUInt32LE(this.pos);return this.pos+=4,e}readDouble(){const e=this.buffer.readDoubleLE(this.pos);return this.pos+=4,e}readString(){const e=this.readU32(),t=this.buffer.toString("utf-8",this.pos,this.pos+e);return this.pos+=e,t}readExpression(){const e=function(e){return Re[e]}(this.readU8());return e.readBinary(this)}readStatement(){const e=function(e){return re[e]}(this.readU8());return e.readBinary(this)}readArray(e){const t=this.readU32(),n=new Array(t);for(var r=0;r<t;r++)n[r]=e();return n}readStringArray(){return this.readArray(this.readString)}readExpressionArray(){return this.readArray(this.readExpression)}readCodeBlock(){return this.readArray(this.readStatement)}}const ie=[{unescaped:'"',escaped:'"'},{unescaped:"n",escaped:"\n"},{unescaped:"t",escaped:"\t"},{unescaped:"r",escaped:"\r"},{unescaped:"\\",escaped:"\\"},{unescaped:"r",escaped:"\r"},{unescaped:"v",escaped:"\v"},{unescaped:"b",escaped:"\b"},{unescaped:"f",escaped:"\f"},{unescaped:"0",escaped:"\0"}];class ae{constructor(e,t){this.scType=e,this.value=t,this.parent=null,this.type=11}static formatNumber(e){switch(e.base){case 10:return e.value.toString();case 16:return"0x"+e.value.toString(16);case 2:return"0b"+e.value.toString(2);default:throw new Error(`Internal error: number base=${e.base}`)}}static formatString(e){return'"'+function(e){for(var t="",n=0;n<e.length;n++){const s=e[n];var r=!1;for(const e of ie)if(s==e.escaped){t+="\\",t+=e.unescaped,r=!0;break}r||(t+=s)}return t}(e)+'"'}computeByteSize(){var e=1;switch(this.scType){case 0:e+=10;break;case 1:e+=se.binaryStringSize(this.value);break;case 2:e+=1}return e}writeBinary(e){switch(e.emitU8(this.scType),this.scType){case 0:const t=this.value,n=Number.isInteger(t.value);e.emitU8(t.base),e.emitU8(n?1:0),Number.isInteger(t)?(e.emitU32(0),e.emitU32(t.value)):e.emitDouble(t.value);break;case 1:e.emitString(this.value);break;case 2:e.emitU8(this.value?1:0)}}toGsString(){switch(this.scType){case 2:return this.value?"yes":"no";case 0:const e=this.value;return isNaN(e.value)?"maggot":ae.formatNumber(e);case 1:return ae.formatString(this.value);case 3:return"semen";default:throw new Error("internal error")}}toJsString(){switch(this.scType){case 2:return this.value?"true":"false";case 0:const e=this.value;return isNaN(e.value)?"NaN":ae.formatNumber(e);case 1:return ae.formatString(this.value);case 3:return"null";default:throw new Error("internal error")}}}class oe{readBinary(e){const t=e.readU8();var n;switch(t){case 0:const t=e.readU8();if(2!=t&&16!=t&&10!=t)throw new Error("Invalid number base");var r;1==e.readU8()?(e.readU32(),r=e.readU32()):r=e.readDouble(),n={base:t,value:r};break;case 1:n=e.readString();break;case 2:n=1==e.readU8();break;case 3:n=null;break;default:throw new Error("Invalid scalar type")}return new ae(t,n)}tryParseGs(e){if(1!=e.length)return null;const t=e.firstToken();switch(t){case"yes":return new ae(2,!0);case"no":return new ae(2,!1);case"semen":return new ae(3,null);case"maggot":return new ae(0,{base:10,value:NaN})}if(t.length>1){const r=t[0],s=t[e.length-1];if('"'==r&&'"'==s){var n=t.substring(1,t.length-1);return n=function(e){for(var t="",n=0;n<e.length;n++){const s=e[n];if("\\"==s){if(n==e.length-1)throw new Error("Wrongly escaped text");const s=e[n+1];var r=!1;for(const e of ie)if(s==e.unescaped){t+=e.escaped,n++,r=!0;break}if(r)continue;throw new Error("Wrongly escaped text")}t+=s}return t}(n),new ae(1,n)}}const r=Number(t);if(!Number.isNaN(r)){var s=10;if(Number.isInteger(r)&&"0"==t[0]&&t.length>1)switch(t[1]){case"x":s=16;break;case"b":s=2}return new ae(0,{base:s,value:r})}return null}tryParseJs(e){if("Literal"==e.type){var t,n;switch(typeof e.value){case"boolean":t=2,n=e.value;break;case"string":t=1,n=e.value;break;case"number":t=0,n={base:10,value:e.value};break;default:t=3,n=null}return new ae(t,n)}return null}}const le=[{gs:"billy",js:"document",propTransformations:[{gs:"createJabroni",js:"createElement"},{gs:"getSlaveBySemen",js:"getElementById"},{gs:"getSlavesByAnal",js:"getElementsByClassName"},{gs:"getSlavesByMaster",js:"getElementsByTagName"}]},{gs:"master",js:"window",propTransformations:[]}];class pe{constructor(e,t){this.object=e,this.property=t,this.parent=null,this.type=9,e.parent=this,t.parent=this}computeByteSize(){return se.binaryExpressionSize(this.object)+se.binaryExpressionSize(this.property)}writeBinary(e){e.emitExpression(this.object),e.emitExpression(this.property)}toGsString(e){return this.object.toGsString(e)+" please "+this.property.toGsString(e)}toJsString(e){var t=this.object,n=this.property;if(t instanceof ue&&n instanceof ue){const e=t.name,i=n.name;for(var r=null,s=0;s<le.length;s++){const n=le[s];if(e==n.gs){t=new ue(n.js),r=n.propTransformations;break}}if(null!=r)for(s=0;s<r.length;s++){const e=r[s];if(i==e.gs){n=new ue(e.js);break}}}return t.toJsString(e)+"."+n.toJsString(e)}}class ce{readBinary(e){const t=e.readExpression(),n=e.readExpression();return new pe(t,n)}tryParseGs(e){const t=e.lastIndexOfOnZeroLevel("please");if(t>0){const n=e.substring(0,t),r=c.parseExpression(n),s=e.substring(t+1,e.length),i=c.parseExpression(s);return new pe(r,i)}return null}tryParseJs(e){if("MemberExpression"==e.type&&!e.computed){const t=e.object;if("Super"==t.type)throw new Error("Super is not supported");const n=qe.parseJsExpression(t),r=qe.parseJsExpression(e.property);return new pe(n,r)}return null}}class ue{constructor(e){this.parent=null,this.type=6,this.name=e}computeByteSize(){return se.binaryStringSize(this.name)}writeBinary(e){e.emitString(this.name)}toGsString(){return this.name}toJsString(){if(this.parent instanceof pe)return this.name;const e=le.find((e=>e.gs==this.name));var t=this.name;return null!=e&&(t=e.js),t}}class he{readBinary(e){const t=e.readString();return new ue(t)}tryParseGs(e){if(1!=e.length)return null;const t=e.firstToken();return E(t)?new ue(t):null}tryParseJs(e){return"Identifier"==e.type?new ue(e.name):null}}class de{constructor(e,t){this.callee=e,this.args=t,this.parent=null,this.type=5,e.parent=this,t.forEach((t=>t.parent=e))}computeByteSize(){var e=se.binaryExpressionSize(this.callee);return e+=se.binaryExpressionArraySize(this.args)}writeBinary(e){e.emitExpression(this.callee),e.emitExpressionArray(this.args)}toStringInternal(e,t){const n=!(this.callee instanceof ue||this.callee instanceof pe);var r=w(t(this.callee,e),n);return r+="(",r+=x(this.args,e,t),r+=")"}toGsString(e){return this.toStringInternal(e,a)}toJsString(e){return this.toStringInternal(e,o)}}class fe{readBinary(e){const t=e.readExpression(),n=e.readExpressionArray();return new de(t,n)}isAllowedExprWithNoBrackets(e){return e instanceof ue||e instanceof pe}tryParseGs(e){if(")"!=e.lastToken())return null;var t=e.findOpenBracketIndexFromEnd(p.Round);if(t<=0)return null;const n=e.substring(0,t),r=c.tryParseExpression(n);if(null==r)return null;if(!(n.length>1&&"("==n.firstToken()&&")"==n.lastToken()||this.isAllowedExprWithNoBrackets(r)))return null;const s=e.substring(t+1,e.length-1);var i=[];if(s.length>0){const e=s.splitOnZeroLevel(",");if(e.length>1){0==e[e.length-1].length&&e.pop()}i=e.map(c.parseExpression)}return new de(r,i)}tryParseJs(e){if("CallExpression"==e.type){const t=e.callee;if("Super"==t.type)throw new Error("Super is not supported");const n=qe.parseJsExpression(t),r=e.arguments.map((e=>{if("SpreadElement"==e.type)throw new Error("JS expression cannot be parsed");return qe.parseJsExpression(e)}));return new de(n,r)}return null}}class ye{constructor(e){this.elements=e,this.parent=null,this.type=0,e.forEach((e=>e.parent=this))}computeByteSize(){return se.binaryExpressionArraySize(this.elements)}writeBinary(e){e.emitExpressionArray(this.elements)}toGsString(e){return"["+x(this.elements,e,a)+"]"}toJsString(e){return"["+x(this.elements,e,o)+"]"}}class ge{readBinary(e){const t=e.readExpressionArray();return new ye(t)}tryParseGs(e){if(e.length>1&&"["==e.firstToken()&&"]"==e.lastToken()){const t=e.substring(1,e.length-1).splitOnZeroLevel(",").map(c.parseExpression);return new ye(t)}return null}tryParseJs(e){if("ArrayExpression"==e.type){const t=e.elements.map((e=>{if(null==e)throw new Error("Internal error: jsElem is null");if("SpreadElement"==e.type)throw new Error("JS expression is unsupported");return qe.parseJsExpression(e)}));return new ye(t)}return null}}class we{constructor(e,t,n){this.params=e,this.body=t,this.inBlock=n,this.parent=null,this.type=8}computeByteSize(){var e=se.binaryStringArraySize(this.params);return e+=se.binaryCodeBlockSize(this.body),e+=1}writeBinary(e){e.emitU8(this.inBlock?1:0),e.emitStringArray(this.params),e.emitCodeBlock(this.body)}toStringInternal(e,t){const n=new l(e),r=e.prettyOutput;switch(this.params.length){case 0:n.append("()");break;case 1:n.append(this.params[0]);break;default:n.append("("),n.append(b(this.params,e)),n.append(")")}return n.append(r?" => ":"=>"),0==this.body.length?n.append("{}"):this.inBlock?(n.openBlock(),n.appendBlock(this.body,t),n.closeBlock()):t(this.body[0],n),n.toString()}toGsString(e){return this.toStringInternal(e,s)}toJsString(e){return this.toStringInternal(e,i)}}class me{readBinary(e){const t=1==e.readU8(),n=e.readStringArray(),r=e.readCodeBlock();return new we(n,r,t)}tryParseGs(e){const t=e.indexOfOnZeroLevel("=>");if(-1==t)return null;const n=e.substring(0,t);var r,s,i;if("("==n.firstToken()){n.expectTokenAt(n.length-1,")");const e=n.substring(1,n.length-1);r=0==e.length?[]:e.splitToSingleTokens(",")}else{if(1!=n.length)throw new Error("Identifier expected");r=[n.firstToken()]}if(!r.every(E))throw new Error("Invalid name for argument");"{"==e.at(t+1)?(e.expectTokenAt(e.length-1,"}"),s=e.substring(t+2,e.length-1),i=!0):(s=e.substring(t+1),i=!1);const a=c.parseCodeBlock(s);return new we(r,a,i)}tryParseJs(e){if("ArrowFunctionExpression"==e.type){const r=e.params.map((e=>{if("Identifier"!=e.type)throw new Error("Lambda cannot be parsed because of params");return e.name})),s=e.body;var t,n;if("BlockStatement"==s.type)t=qe.parseJsBlock(s.body),n=!0;else{const e=qe.parseJsExpression(s);t=[new f(e)],n=!1}return new we(r,t,n)}return null}}function be(e){e.expectTokenAt(1,"=");const t=e.firstToken();if(!E(t))throw new Error("Invalid property name");const n=e.substring(2);return{name:t,value:c.parseExpression(n)}}class xe{constructor(e){this.properties=e,this.parent=null,this.type=1}computeByteSize(){var e=4;for(const t of this.properties)e+=se.binaryStringSize(t.name),e+=se.binaryExpressionSize(t.value);return e}writeBinary(e){e.emitU32(this.properties.length);for(const t of this.properties)e.emitString(t.name),e.emitExpression(t.value)}toStringInternal(e,t,n){const r=e.prettyOutput;var s="";s+=r?"{ ":"{";const i=r?", ":",";return this.properties.forEach(((a,o)=>{s+=a.name,"="==t&&r&&(s+=" "),s+=t,r&&(s+=" "),s+=n(a.value,e),o<this.properties.length-1&&(s+=i)})),s+=r?" }":"}"}toGsString(e){return this.toStringInternal(e,"=",a)}toJsString(e){return this.toStringInternal(e,":",o)}}class Se{readBinary(e){const t=e.readU32(),n=new Array(t);for(var r=0;r<t;r++){const t=e.readString(),s=e.readExpression();n[r]={name:t,value:s}}return new xe(n)}tryParseGs(e){if(e.length>1&&"{"==e.firstToken()&&"}"==e.lastToken()){const t=e.substring(1,e.length-1).splitOnZeroLevel(",").map(be);return new xe(t)}return null}tryParseJs(e){if("ObjectExpression"==e.type){const t=e.properties.map((e=>{if("Property"==e.type){const n=e.key;var t;if("Identifier"!=n.type)throw new Error("Invalid key in object declaration");t=n.name;const r=e.value;if("AssignmentPattern"==r.type||"ArrayPattern"==r.type||"ObjectPattern"==r.type)throw new Error("JS expression cannot be parsed");return{name:t,value:qe.parseJsExpression(r)}}throw new Error("JS cannot be parsed")}));return new xe(t)}return null}}class ke{constructor(e,t,n){this.condition=e,this.consequent=t,this.alternate=n,this.parent=null,this.type=4,e.parent=this,t.parent=this,n.parent=this}computeByteSize(){return se.binaryExpressionSize(this.condition)+se.binaryExpressionSize(this.consequent)+se.binaryExpressionSize(this.alternate)}writeBinary(e){e.emitExpression(this.condition),e.emitExpression(this.consequent),e.emitExpression(this.alternate)}toStringInternal(e,t){function n(e){return e instanceof Ae||e instanceof ke}const r=e.prettyOutput?" ":"";var s="";return n(this.condition)?s+=`(${t(this.condition,e)})`:s+=t(this.condition,e),s+=r+"?"+r,n(this.consequent)?s+=`(${t(this.consequent,e)})`:s+=t(this.consequent,e),s+=r+":"+r,n(this.alternate)?s+=`(${t(this.alternate,e)})`:s+=t(this.alternate,e),s}toGsString(e){return this.toStringInternal(e,a)}toJsString(e){return this.toStringInternal(e,o)}}class Ee{readBinary(e){const t=e.readExpression(),n=e.readExpression(),r=e.readExpression();return new ke(t,n,r)}tryParseGs(e){const t=e.indexOfOnZeroLevel("?");if(t>0){const n=e.substring(t,e.length).indexOfOnZeroLevel(":");if(n<0)throw new Error(": is not found");const r=e.substring(0,t),s=c.parseExpression(r),i=e.substring(t+1,n),a=c.parseExpression(i),o=e.substring(n+1,e.length),l=c.parseExpression(o);return new ke(s,a,l)}return null}tryParseJs(e){if("ConditionalExpression"==e.type){const t=qe.parseJsExpression(e.test),n=qe.parseJsExpression(e.consequent),r=qe.parseJsExpression(e.alternate);return new ke(t,n,r)}return null}}function Be(e,t){return e.find((e=>e.repr==t))}function ve(e,t){return e.find((e=>e.id==t))}function Je(e,t){return{id:e,repr:t}}function Ie(e,t){return{id:e,repr:t,position:"left"}}function ze(e,t){return{id:e,repr:t,position:"right"}}const Te=(e,t)=>t.repr.length-e.repr.length,Ce=[Ie(0,"!"),Ie(1,"~"),Ie(2,"++"),Ie(3,"--"),Ie(4,"-"),Ie(5,"+")].sort(Te),Ue=[ze(6,"++"),ze(7,"--")].sort(Te),Pe=[Je(0,"&"),Je(1,"|"),Je(2,"+"),Je(3,"-"),Je(4,"*"),Je(5,"/"),Je(6,"&&"),Je(7,"||"),Je(8,"<"),Je(9,">"),Je(10,"<="),Je(11,">="),Je(12,"=="),Je(13,"!=")].sort(Te);class Ae{constructor(e,t,n){this.left=e,this.right=t,this.op=n,this.parent=null,this.type=2,e.parent=this,t.parent=this}computeByteSize(){return se.binaryExpressionSize(this.left)+se.binaryExpressionSize(this.right)+1}writeBinary(e){e.emitU8(this.op.id),e.emitExpression(this.left),e.emitExpression(this.right)}toStringInternal(e,t){function n(e){return e instanceof Ae||e instanceof ke}const r=e.prettyOutput?" ":"";var s=w(t(this.left,e),n(this.left));return s+=r+this.op.repr+r,s+=w(t(this.right,e),n(this.right))}toGsString(e){return this.toStringInternal(e,a)}toJsString(e){return this.toStringInternal(e,o)}}class Ge{readBinary(e){const t=e.readU8(),n=ve(Pe,t);if(null==n)throw new Error("Invalid op id");const r=e.readExpression(),s=e.readExpression();return new Ae(r,s,n)}tryParseGs(e){for(var t=0;t<Pe.length;t++){const n=Pe[t],r=e.indexOfOnZeroLevel(n.repr);if(r>0){const t=e.substring(0,r),s=e.substring(r+1,e.length);if(0==t.length||0==s.length)return null;const i=c.parseExpression(t),a=c.parseExpression(s);return new Ae(i,a,n)}}return null}tryParseJs(e){if("BinaryExpression"==e.type||"LogicalExpression"==e.type){const n=qe.parseJsExpression(e.left),r=qe.parseJsExpression(e.right),s=(t=e.operator,Be(Pe,t));if(null==s)throw new Error(`JS operator '${e.operator} cannot be parsed'`);return new Ae(n,r,s)}var t;return null}}class Oe{constructor(e,t){this.expr=e,this.op=t,this.parent=null,this.type=3,e.parent=this}computeByteSize(){return+se.binaryExpressionSize(this.expr)+1}writeBinary(e){e.emitU8(this.op.id),e.emitExpression(this.expr)}toStringInternal(e,t){return"left"==this.op.position?this.op.repr+t(this.expr,e):t(this.expr,e)+this.op.repr}toGsString(e){return this.toStringInternal(e,a)}toJsString(e){return this.toStringInternal(e,o)}}class Ne{readBinary(e){const t=function(e){var t=ve(Ce,e);return null==t&&(t=ve(Ue,e)),t}(e.readU8());if(null==t)throw new Error("Invalid op id");const n=e.readExpression();return new Oe(n,t)}tryParseGs(e){if(e.length<=1)return null;var t=null,n=null;const r=e.firstToken();for(var s=0;s<Ce.length;s++){const i=Ce[s];if(r==i.repr){t=e.substring(1),n=i;break}}if(null==n){const r=e.lastToken();for(s=0;s<Ue.length;s++){const i=Ue[s];if(r==i.repr){t=e.substring(0,e.length-1),n=i;break}}}if(null!=n&&null!=t){const e=c.parseExpression(t);return new Oe(e,n)}return null}tryParseJs(e){if("UnaryExpression"==e.type||"UpdateExpression"==e.type){const n=qe.parseJsExpression(e.argument),r=(t=e.operator,Be("left"==(e.prefix?"left":"right")?Ce:Ue,t));if(null==r)throw new Error(`Operator '${e.operator}' cannot be parsed`);return new Oe(n,r)}var t;return null}}class Le{constructor(e,t){this.callee=e,this.args=t,this.parent=null,this.type=10,e.parent=this,t.forEach((t=>t.parent=e))}computeByteSize(){var e=se.binaryExpressionSize(this.callee);return e+=se.binaryExpressionArraySize(this.args)}writeBinary(e){e.emitExpression(this.callee),e.emitExpressionArray(this.args)}toStringInternal(e,t){var n="new ";return n+=t(this.callee,e),n+="(",n+=x(this.args,e,t),n+=")"}toGsString(e){return this.toStringInternal(e,a)}toJsString(e){return this.toStringInternal(e,o)}}class je{readBinary(e){const t=e.readExpression(),n=e.readExpressionArray();return new Le(t,n)}tryParseGs(e){if(e.length>0&&"new"==e.firstToken()){const t=e.findOpenBracketIndexFromEnd(p.Round);if(-1==t)throw new Error("( expected");e.expectTokenAt(e.length-1,")");const n=e.substring(1,t),r=c.parseExpression(n),s=e.substring(t+1,e.length-1).splitOnZeroLevel(",").map(c.parseExpression);return new Le(r,s)}return null}tryParseJs(e){if("NewExpression"==e.type){const t=qe.parseJsExpression(e.callee),n=e.arguments.map((e=>{if("SpreadElement"==e.type)throw new Error("Spread element cannot be parsed in arguments");return qe.parseJsExpression(e)}));return new Le(t,n)}return null}}class Ve{constructor(e,t){this.obj=e,this.index=t,this.parent=null,this.type=7,e.parent=this,t.parent=e}computeByteSize(){return se.binaryExpressionSize(this.obj)+se.binaryExpressionSize(this.index)}writeBinary(e){e.emitExpression(this.obj),e.emitExpression(this.index)}toStringInternal(e,t){var n=t(this.obj,e);return n+="[",n+=t(this.index,e),n+="]"}toGsString(e){return this.toStringInternal(e,a)}toJsString(e){return this.toStringInternal(e,o)}}class We{readBinary(e){const t=e.readExpression(),n=e.readExpression();return new Ve(t,n)}tryParseGs(e){if("]"==e.lastToken()){const t=e.findOpenBracketIndexFromEnd(p.Square);if(t<=0)return null;const n=e.substring(0,t),r=c.parseExpression(n),s=e.substring(t+1,e.length-1),i=c.parseExpression(s);return new Ve(r,i)}return null}tryParseJs(e){if("MemberExpression"==e.type&&e.computed){const t=e.object;if("Super"==t.type)throw new Error("Super is not supported");const n=qe.parseJsExpression(t),r=qe.parseJsExpression(e.property);return new Ve(n,r)}return null}}const Ze=[new Ee,new oe,new Ge,new Ne,new je,new fe,new ge,new me,new Se,new We,new ce,new he],Re=[new ge,new Se,new Ge,new Ne,new Ee,new fe,new he,new We,new me,new ce,new je,new oe];class qe{static parseJsBlockOrSingle(e){return"BlockStatement"==e.type?this.parseJsBlock(e.body):[this.parseJsStatement(e)]}static parseJsStatement(e){for(const t of ne){const n=t.tryParseJs(e);if(null!=n)return n}throw new Error("JS statement cannot be parsed")}static parseJsBlock(e){return e.map(this.parseJsStatement)}static tryParseJsExpression(e){for(const t of Ze){const n=t.tryParseJs(e);if(null!=n)return n}return null}static parseJsExpression(e){const t=this.tryParseJsExpression(e);if(null==t)throw new Error("JS expression cannot be parsed");return t}}const De=[{content:"sir",spaceAfter:!0},{content:"slave",spaceAfter:!0},{content:"van",literal:!0},{content:"cumming",literal:!0},{content:"=>"},{content:";"},{content:"("},{content:")"},{content:"["},{content:"]"},{content:"{"},{content:"}"},{content:"<"},{content:">"},{content:"<="},{content:">="},{content:"++"},{content:"--"},{content:"+"},{content:"-"},{content:"*"},{content:"/"},{content:"=="},{content:"!="},{content:"="},{content:"!"},{content:"&&"},{content:"||"},{content:"&"},{content:"|"},{content:"~"},{content:"^"},{content:"return",literal:!0},{content:"do",literal:!0},{content:"anal",literal:!0},{content:"please",spaceBefore:!0,spaceAfter:!0},{content:"break",literal:!0},{content:"continue",literal:!0},{content:"try",literal:!0},{content:"catch",literal:!0},{content:"finally",literal:!0},{content:"fisting",literal:!0,spaceAfter:!0},{content:"if",literal:!0},{content:"elif",literal:!0},{content:"else",literal:!0},{content:"penetrate-with",literal:!0,spaceAfter:!0},{content:"new",literal:!0,spaceAfter:!0},{content:'"'},{content:"?"},{content:":"},{content:","}];class Fe{constructor(e,t,n){if(this.tokens=e,this.start=t,t>n)throw new Error("start > end");this.length=n-t}firstToken(){if(0==this.length)throw new Error("Lex string is empty");return this.tokens[this.start]}lastToken(){if(0==this.length)throw new Error("Lex string is empty");return this.tokens[this.start+this.length-1]}expectTokenAt(e,t){if(e<0)throw new Error("Index was out of bounds");if(e>=this.length||this.atUnchecked(e)!=t)throw new Error(t+" expected")}forEachOnZeroLevel(e){for(var t=0,n=0;n<this.length;n++){const r=this.atUnchecked(n);switch(r){case"[":case"{":case"(":t++;break;case"]":case"}":case")":t--}if(0==t){const t=e(r,n);if("boolean"==typeof t&&t)break}}}reversedForEachOnZeroLevel(e){for(var t=0,n=0;n<this.length;n++){const r=this.atUnchecked(n);switch(r){case"[":case"{":case"(":t++;break;case"]":case"}":case")":t--}if(0==t){const t=e(r,n);if("boolean"==typeof t&&t)break}}}isBracketSequenceValid(){for(var e=0,t=this.start;t<this.start+this.length;t++){switch(this.tokens[t]){case"[":case"{":case"(":e++;break;case"]":case"}":case")":if(--e<0)return!1}}return!0}findOpenBracketIndexFromEnd(e){const t=function(e){switch(e){case p.Round:return"(";case p.Square:return"[";case p.Curl:return"{"}}(e);for(var n=0,r=this.length-1;r>=0;r--){const e=this.atUnchecked(r);switch(e){case"(":case"{":case"[":if(n++,e==t&&0==n)return r;break;case")":case"}":case"]":n--}}return-1}findClosingBracketIndex(e){const t=function(e){switch(e){case p.Round:return")";case p.Square:return"]";case p.Curl:return"}"}}(e);for(var n=0,r=0;r<this.length;r++){const e=this.atUnchecked(r);switch(e){case"(":case"{":case"[":n++;break;case")":case"}":case"]":if(0==--n&&e==t)return r}}return-1}indexOfOnZeroLevel(e){var t=-1;return this.forEachOnZeroLevel(((n,r)=>{if(n==e)return t=r,!0})),t}lastIndexOfOnZeroLevel(e){var t=-1;return this.reversedForEachOnZeroLevel(((n,r)=>{if(n==e)return t=r,!0})),t}indexOf(e){for(var t=0;t<this.length;t++)if(this.atUnchecked(t)==e)return t;return-1}splitToSingleTokens(e){const t=[];for(var n=0,r=0;r<this.length;r++){const s=this.atUnchecked(r),i=r==this.length-1;if(s==e||i){if((i?this.length:r)-n!=1)throw new Error("Identifier expected");const e=this.at(n);n=r+1,t.push(e)}}return t}splitOnZeroLevel(e){const t=[];var n=0;this.forEachOnZeroLevel(((r,s)=>{if(r==e){const e=this.substring(n,s);n=s+1,t.push(e)}}));const r=this.substring(n);return r.length>0&&t.push(r),t}atUnchecked(e){return this.tokens[this.start+e]}at(e){if(e<0||e>=this.length)throw new Error("Index is out of bounds");return this.atUnchecked(e)}substring(e,t=this.length){return new Fe(this.tokens,this.start+e,this.start+t)}toString(){for(var e="",t=this.start;t<this.start+this.length;t++)e+=this.tokens[t];return e}}class He{constructor(e,t,n){this.initialCode=e,this.preparedCode=t,this.block=n}}function $e(e){const t=function(e){for(var t=!1,n="",r=0;r<e.length;r++)if('"'==e[r]&&(r>0&&"\\"==e[r-1]||(t=!t)),!t&&m(e,r,"//")){var s=e.indexOf("\n",r);s<0&&(s=e.length),r=s}else n+=e[r];return n}(e),n=function(e){const t=[];for(var n=0,r=!1,s=0;s<e.length;s++){if('"'==e[s]&&!(s>0&&"\\"==e[s-1])){if(r){r=!1,t.push(e.substring(n,s+1).trim()),n=s+1;continue}r=!0}if(!r)for(var i=0;i<De.length;i++){const r=De[i];var a=s;if(r.spaceBefore){if(" "!=e[s])continue;a++}if(m(e,a,r.content)){var o=a+r.content.length;if(r.spaceAfter){if(" "!=e[o])break;o++}else if(r.literal&&o<e.length&&k(e[o]))break;const i=e.substring(n,s).trim();i.length>0&&t.push(i),t.push(r.content),s=(n=o)-1;break}}}const l=e.substring(n).trim();return l.length>0&&t.push(l),new Fe(t,0,t.length)}(t),r=c.parseCodeBlock(n);return new He(e,t,r)}function Me(e,t={prettyOutput:!0}){const n=new l(t);return n.appendBlock(e.block,((e,t)=>e.appendJs(t))),n.toString()}function _e(e,t={prettyOutput:!0}){return Me($e(e),t)}function Ke(e){const t=(0,r.parse)(e).body,n=qe.parseJsBlock(t),i=new l;return i.appendBlock(n,s),i.toString()}}}]);